Right Sidebar Refactoring - План задач
======================================

КРИТИЧНЫЕ (Архитектура)
=======================

[x] 1. Объединить источники настроек
    --------------------------------
    ПРОБЛЕМА: Два источника правды для настроек экспорта
    - useExport() хранит в localStorage как 'export-settings'
    - settingsStore хранит в localStorage как 'app-settings'
    - Часть опций синхронизируется вручную (stripComments), часть нет
    
    ГДЕ:
    - frontend/src/composables/useExport.ts
    - frontend/src/stores/settings.store.ts
    - frontend/src/components/workspace/sidebar/ExportSettings.vue
    
    КАК ИСПРАВИТЬ:
    1. Перенести ВСЕ настройки экспорта в settingsStore.context
    2. Удалить дублирование в useExport - оставить только логику экспорта
    3. Удалить localStorage 'export-settings' - использовать только 'app-settings'
    4. ExportSettings.vue должен работать только с settingsStore
    
    СДЕЛАНО:
    - Добавлены поля в ContextSettings: includeManifest, includeLineNumbers, enableAutoSplit, maxTokensPerChunk
    - useExport теперь использует computed от settingsStore (single source of truth)
    - ExportSettings.vue работает напрямую с settingsStore
    - Удалён localStorage 'export-settings'
    - Унифицирован splitStrategy: 'smart' | 'file' | 'token' везде

[x] 2. Разбить ExportSettings.vue на компоненты
    -------------------------------------------
    ПРОБЛЕМА: 11 переключателей в одном компоненте, нет группировки
    
    ГДЕ: frontend/src/components/workspace/sidebar/ExportSettings.vue (230+ строк)
    
    КАК ИСПРАВИТЬ:
    Создать в frontend/src/components/workspace/sidebar/export/:
    - FormatSelector.vue - выбор формата (XML/Markdown/Plain/JSON)
    - OutputOptions.vue - метаданные, номера строк, комментарии
    - OptimizationOptions.vue - excludeTests, stripLicense, compactData, trim, collapse
    - ChunkingOptions.vue - авто-разбиение, токены на чанк, стратегия
    - TokenLimitSlider.vue - слайдер лимита токенов
    
    ExportSettings.vue станет контейнером с collapsible секциями
    
    СДЕЛАНО:
    - Создан SettingsToggle.vue - переиспользуемый toggle компонент
    - Создан FormatSelector.vue - выбор формата
    - Создан OutputOptions.vue - метаданные, номера строк, комментарии
    - Создан OptimizationOptions.vue - 5 опций оптимизации
    - Создан ChunkingOptions.vue - авто-разбиение с настройками
    - Создан TokenLimitSlider.vue - слайдер лимита токенов
    - ExportSettings.vue теперь чистый контейнер (~70 строк)

[x] 3. Вынести toggle стили в design-tokens.css
    -------------------------------------------
    ПРОБЛЕМА: Scoped стили для toggle в ExportSettings.vue
    
    ГДЕ: 
    - frontend/src/components/workspace/sidebar/ExportSettings.vue (style scoped)
    - frontend/src/assets/design-tokens.css
    
    КАК ИСПРАВИТЬ:
    Добавить в design-tokens.css:
    ```css
    .toggle-label { ... }
    .toggle-container { ... }
    .toggle-track { ... }
    .toggle-thumb { ... }
    .peer:checked ~ .toggle-track { ... }
    .peer:checked ~ .toggle-thumb { ... }
    ```
    Удалить scoped стили из ExportSettings.vue


СЕРЬЁЗНЫЕ (UI/UX)
=================

[x] 4. FileTypeStats.vue - исправить иконки
    ---------------------------------------
    ПРОБЛЕМА: 
    - Иконки показывают текст ('typescript') вместо эмодзи/SVG
    - Дублирование FILE_TYPE_CONFIG - уже есть fileIcons.ts
    - Progress bar для папок - инлайн стили
    
    ГДЕ: frontend/src/components/workspace/sidebar/FileTypeStats.vue
    
    КАК ИСПРАВИТЬ:
    1. Импортировать getFileIcon из '@/utils/fileIcons'
    2. Удалить локальный FILE_TYPE_CONFIG
    3. Заменить stat.icon на вызов getFileIcon(stat.extension)
    4. Добавить класс .progress-bar-folder в design-tokens.css
    
    СДЕЛАНО:
    - Импортирован FILE_TYPE_CONFIG из '@/utils/fileIcons'
    - Удалён локальный дубликат FILE_TYPE_CONFIG
    - Добавлен .progress-bar-fill-folder в design-tokens.css

[x] 5. AISettings.vue - разбить на компоненты
    -----------------------------------------
    ПРОБЛЕМА: 280 строк, смешение логики и UI
    
    ГДЕ: frontend/src/components/workspace/sidebar/AISettings.vue
    
    КАК ИСПРАВИТЬ:
    Создать в frontend/src/components/workspace/sidebar/ai/:
    - ProviderSelector.vue - выбор провайдера
    - ApiKeyInput.vue - ввод API ключа с show/hide
    - ModelSelector.vue - выбор модели
    - HostUrlInput.vue - URL для LocalAI/Qwen
    
    Вынести логику в composable useAISettings.ts
    
    СДЕЛАНО:
    - Создан useAISettings.ts composable - вся логика вынесена
    - Создан ProviderSelector.vue с lucide иконками
    - Создан ApiKeyInput.vue с show/hide и clear
    - Создан ModelSelector.vue
    - Создан HostUrlInput.vue
    - Создан QwenCliInfo.vue - информация о CLI
    - Создан StatusMessage.vue - сообщения об успехе/ошибке
    - AISettings.vue теперь чистый контейнер (~100 строк)

[x] 6. RightSidebar.vue - заменить h() иконки на lucide
    ---------------------------------------------------
    ПРОБЛЕМА: Иконки через h() функции - громоздко (50+ строк)
    
    ГДЕ: frontend/src/components/workspace/RightSidebar.vue (строки 60-90)
    
    КАК ИСПРАВИТЬ:
    ```vue
    import { BarChart3, FileDown, FileText, MessageCircle, Settings } from 'lucide-vue-next'
    
    const tabs = [
      { id: 'stats', icon: BarChart3, ... },
      { id: 'export', icon: FileDown, ... },
      ...
    ]
    ```

[x] 7. Вынести tabs-indicator стили в design-tokens
    -----------------------------------------------
    ПРОБЛЕМА: Scoped стили tabs-indicator-* в RightSidebar.vue
    
    ГДЕ:
    - frontend/src/components/workspace/RightSidebar.vue (style scoped)
    - frontend/src/assets/design-tokens.css
    
    КАК ИСПРАВИТЬ:
    Добавить в design-tokens.css:
    ```css
    .tabs-indicator { ... }
    .tabs-indicator-indigo { ... }
    .tabs-indicator-emerald { ... }
    .tabs-indicator-orange { ... }
    .tabs-indicator-purple { ... }
    ```

[x] 8. PromptTemplates.vue - вынести стили (section-icon-*, info-box-* добавлены)
    --------------------------------------
    ПРОБЛЕМА: 
    - section-icon-orange, section-icon-purple не в design-tokens
    - slide-fade transition не в animations.css
    
    ГДЕ: frontend/src/components/workspace/sidebar/PromptTemplates.vue
    
    КАК ИСПРАВИТЬ:
    1. Добавить .section-icon-orange, .section-icon-purple в design-tokens.css
    2. Добавить .slide-fade-* в animations.css


ЛОКАЛИЗАЦИЯ
===========

[x] 9. ExportSettings.vue - локализовать тексты
    -------------------------------------------
    НЕЛОКАЛИЗОВАНО:
    - "Авто-разбиение на чанки"
    - "Токенов на чанк"
    - "Стратегия"
    - "Smart", "По файлам", "По токенам"
    - "Лимит токенов"
    - "1K", "128K"
    
    ГДЕ: 
    - frontend/src/components/workspace/sidebar/ExportSettings.vue
    - frontend/src/composables/useI18n.ts
    
    КАК ИСПРАВИТЬ:
    Добавить в useI18n.ts (ru + en):
    - 'export.autoSplit': 'Авто-разбиение на чанки' / 'Auto-split into chunks'
    - 'export.tokensPerChunk': 'Токенов на чанк' / 'Tokens per chunk'
    - 'export.strategy': 'Стратегия' / 'Strategy'
    - 'export.strategySmart': 'Smart' / 'Smart'
    - 'export.strategyFile': 'По файлам' / 'By files'
    - 'export.strategyToken': 'По токенам' / 'By tokens'
    - 'export.tokenLimit': 'Лимит токенов' / 'Token limit'

[x] 10. PromptTemplates.vue - локализовать
    --------------------------------------
    НЕЛОКАЛИЗОВАНО:
    - "Custom" (заголовок секции)
    - Контент defaultTemplates (content, preview)
    
    ГДЕ: frontend/src/components/workspace/sidebar/PromptTemplates.vue
    
    КАК ИСПРАВИТЬ:
    1. Заменить "Custom" на t('prompts.custom')
    2. Сделать defaultTemplates computed с t() для content/preview

[x] 11. AISettings.vue - локализовать
    ---------------------------------
    НЕЛОКАЛИЗОВАНО:
    - "Qwen Code CLI"
    - Описания провайдеров (description)
    - Hints для API ключей
    - "Использует локально установленный qwen-coder-cli..."
    
    ГДЕ: frontend/src/components/workspace/sidebar/AISettings.vue
    
    СДЕЛАНО:
    - Добавлены переводы settings.provider.*, settings.hint.*
    - Добавлены settings.qwenCliTitle, settings.qwenCliDescription
    - Добавлены settings.showKey, settings.hideKey, settings.clearKey
    - providers теперь computed с локализованными описаниями


МЕЛКИЕ (Стили)
==============

[x] 12. Унифицировать padding инпутов
    ---------------------------------
    ПРОБЛЕМА: Разные !py-* для инпутов: !py-1.5, !py-2, !py-2.5
    
    ГДЕ: ExportSettings.vue, AISettings.vue
    
    КАК ИСПРАВИТЬ:
    Использовать единый класс .input без переопределения padding
    Или добавить .input-sm, .input-md в design-tokens.css
    
    СДЕЛАНО:
    - Добавлены .input-xs, .input-sm, .input-md в design-tokens.css
    - Добавлен .textarea-sm в design-tokens.css
    - Заменены !py-* на классы в AISettings, ExportSettings, PromptTemplates

[x] 13. Заменить text-[10px] на CSS переменную (.text-2xs добавлен)
    ------------------------------------------
    ПРОБЛЕМА: Магическое число text-[10px] в нескольких местах
    
    ГДЕ: ExportSettings.vue, AISettings.vue, FileTypeStats.vue
    
    КАК ИСПРАВИТЬ:
    Добавить в design-tokens.css:
    ```css
    .text-2xs { font-size: 10px; line-height: 14px; }
    ```
    Заменить text-[10px] на text-2xs

[x] 14. Заменить инлайн цвета на CSS переменные
    -------------------------------------------
    ПРОБЛЕМА: border-indigo-500/30 и подобные инлайн
    
    ГДЕ: ExportSettings.vue (border-l-2 border-indigo-500/30)
    
    КАК ИСПРАВИТЬ:
    Добавить класс .border-accent-indigo в design-tokens.css
    Или использовать var(--accent-indigo) с opacity
    
    СДЕЛАНО:
    - Добавлены .border-l-accent-indigo, .border-l-accent-purple
    - Добавлены .status-message, .status-message-success, .status-message-error
    - Заменены инлайн стили в ExportSettings и AISettings


ПОРЯДОК ВЫПОЛНЕНИЯ
==================
1. Задача 1 (объединить настройки) - база для остального
2. Задачи 3, 7, 8 (вынести стили) - подготовка
3. Задача 2 (разбить ExportSettings) - основной рефакторинг
4. Задачи 9, 10, 11 (локализация) - можно параллельно
5. Задачи 4, 5, 6 (улучшения компонентов)
6. Задачи 12, 13, 14 (мелкие стили) - в конце
