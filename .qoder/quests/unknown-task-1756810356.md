# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ OutOfMemory –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ Shotgun Code

## –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–±–ª–µ–º

### –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –≤—ã—è–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ò–∑–±—ã—Ç–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ reactive state**
   - –í `context-builder.store.ts` —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
   - VirtualScrollViewer —Å–æ–∑–¥–∞–µ—Ç –±–æ–ª—å—à–∏–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

2. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤**
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç streaming –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
   - –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å virtual scrolling**
   - –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ —Å—Ç—Ä–æ–∫ –≤ –ø–∞–º—è—Ç–∏
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞

4. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏**
   - –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
   - –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é

``mermaid
graph TD
    A[Frontend Memory Management] --> B[Streaming Data]
    A --> C[Lazy Loading]
    A --> D[Memory Monitoring]
    A --> E[Garbage Collection]
    
    B --> F[Chunked Context Loading]
    B --> G[Virtual Scrolling Optimization]
    
    C --> H[Component-level Cleanup]
    C --> I[Progressive File Loading]
    
    D --> J[Real-time Memory Tracking]
    D --> K[Threshold-based Warnings]
    
    E --> L[Automatic Cleanup]
    E --> M[Manual GC Triggers]
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

1. **Enhanced Memory Monitor**
   - –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ (–∫–∞–∂–¥—ã–µ 1000ms)
   - –°–Ω–∏–∂–µ–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (40MB warning, 60MB critical)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

2. **Optimized Virtual Scrolling**
   - Line-by-line extraction –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–∏–º—ã—Ö —Å—Ç—Ä–æ–∫
   - Streaming support –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

3. **Context Builder Improvements**
   - –ó–∞–º–µ–Ω–∞ –ø–æ–ª–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ ContextSummary
   - Chunked processing —Å —Ä–∞–∑–º–µ—Ä–æ–º —á–∞–Ω–∫–æ–≤ 50KB
   - Streaming context support

4. **Memory Cleanup Utilities**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - Forced garbage collection –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–º–µ–Ω—Ç–∞—Ö
   - Clearing –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏–∑ –ø–∞–º—è—Ç–∏

## File and Folder Selection Crash Issues

### Critical Selection Problems Identified

After analyzing the codebase, additional critical issues were found with element selection:

1. **Unlimited Folder Selection**
   - Selecting folders with large numbers of files triggers cascade selection
   - `toggleCascade()` can process thousands of files simultaneously
   - No protection against selecting root folders with 10,000+ files

2. **Memory leaks in tri-state selection**
   - Recursive processing of `computeSelection()` for large trees
   - Stack overflow with deep folder nesting
   - Missing cleanup on component unmount

3. **Reactive Set object issues**
   - `selectedPaths` and `expandedPaths` use Set without proper cleanup
   - Vue reactivity on large Set objects causes memory pressure
   - Missing debouncing for multiple selections

4. **Inefficient UI updates**
   - Each `toggleNodeSelection` triggers full re-render
   - `updateParentSelection` recalculates for entire hierarchy
   - Missing virtualization for large file lists

### Critical Selection Fixes Architecture

```mermaid
graph TD
    A[File Selection Issues] --> B[Cascade Selection Limits]
    A --> C[Reactive Set Cleanup]
    A --> D[UI Update Optimization]
    A --> E[Memory-Safe Recursion]
    
    B --> F[Max 100 files per folder]
    B --> G[Max depth 5 levels]
    
    C --> H[Auto-cleanup on unmount]
    C --> I[Debounced updates]
    
    D --> J[Virtualized file lists]
    D --> K[Batched state updates]
    
    E --> L[Stack size limits]
    E --> M[Breadth-first traversal]
```

### Implementation Strategy

#### Phase 1: Immediate Protection (Critical Priority)

1. **Selection Limits Implementation**
   - Maximum 100 files per cascade selection
   - Maximum recursion depth of 5 levels
   - Breadth-first traversal instead of recursive processing
   - User warnings for large folder selections

2. **Click Protection System**
   - Debouncing for rapid clicks (300ms minimum interval)
   - Processing state locks to prevent concurrent operations
   - Error boundaries for selection failures
   - Memory monitoring during selection operations

3. **Reactive State Management**
   - Automatic Set cleanup when exceeding limits (200 selected, 50 expanded)
   - Debounced state updates to prevent thrashing
   - Manual garbage collection triggers after large operations
   - Component-level cleanup on unmount

#### Phase 2: Performance Optimization (High Priority)

1. **Smart Selection Algorithms**
   - Count-first approach before selection operations
   - User confirmation dialogs for operations > 100 files
   - Progressive selection with cancellation support
   - Memory usage estimation before operations

2. **UI Responsiveness**
   - Virtual scrolling for file lists > 200 items
   - Batched DOM updates for selection changes
   - Loading indicators for heavy operations
   - Background processing for large selections

### Testing Strategy for Selection Issues

#### Critical Test Scenarios

1. **Large Folder Selection Test**
   - Attempt to select folder with 500+ files
   - Verify blocking and user warnings
   - Memory usage must stay < 5MB during operation

2. **Rapid Click Test**
   - 20 rapid clicks on file items
   - No crashes or memory leaks
   - Proper final selection state

3. **Memory Cleanup Test**
   - Fill selectedPaths beyond limits
   - Verify automatic cleanup activation
   - Final Set size within limits

### Expected Results

#### Crash Prevention
- Zero browser crashes during file selection
- Protected against large folder operations
- Graceful degradation with user feedback
- Memory usage stays predictable < 25MB

#### Performance Improvements
- Selection operations complete within 1 second
- UI remains responsive during operations
- Automatic cleanup prevents memory accumulation
- User warnings prevent problematic operations

## Detailed Implementation Plan

### Phase 1: Critical Memory Fixes (High Priority)

#### 1. Memory Monitor Updates (CRITICAL)

**Problem**: Current thresholds too high (70% heap) causing OOM before warnings trigger.

**Solution Strategy**:
- Replace percentage-based thresholds with absolute MB values
- Warning at 15MB, Critical at 25MB, Emergency at 35MB
- Increase monitoring frequency from 5000ms to 500ms
- Add aggressive garbage collection intervals
- Implement emergency memory unload procedures

#### 2. VirtualScrollViewer Optimization (CRITICAL)

**Problem**: Creating large arrays when splitting content.

**Current Status**:
- ‚úÖ Line-by-line extraction already implemented
- ‚úÖ 5000 line limit established
- üîÑ Need more aggressive cleanup

**Additional Improvements**:
- Reduce overscan to minimum (0-1 lines)
- Limit visible lines to 100 maximum
- Add memory cleanup intervals every 5 seconds
- Implement component-level cleanup on unmount

#### 3. Context Builder Store Optimization (CRITICAL)

**Problem**: 
- Large file size limits still too high
- Missing streaming support completion
- Reactive state memory pressure

**Current Status**:
- ‚úÖ shotgunContextText removed in favor of ContextSummary
- ‚úÖ Streaming context partially implemented
- üîÑ Need to reduce limits further

**New Critical Limits**:
- File limit: 25 files (reduced from 50)
- Individual file size: 64KB (reduced from 128KB)
- Total context size: 512KB (reduced from 1MB)
- Chunk size: 25KB (reduced from 50KB)
- Memory warning: 20MB (reduced from 30MB)

### Phase 2: Emergency Action Items (Critical Priority)

#### 1. Component Memory Cleanup

**Immediate Actions**:
- Add cleanup hooks to all Vue components
- Clear large data references on unmount
- Force garbage collection after cleanup
- Remove event listeners properly
- Clear timeouts and intervals

#### 2. Emergency Context Builder Limits

**Emergency Limits** (4x reduction):
- Maximum files: 10 (critically low limit)
- File size: 32KB maximum
- Context size: 256KB maximum
- Chunk size: 16KB chunks
- Memory warning: 15MB threshold
- Selected files: 10 maximum

#### 3. Forced Garbage Collection

**Automatic GC Implementation**:
- Monitor memory every 3 seconds
- Force GC when usage > 20MB
- Emergency cleanup at 25MB+
- Cleanup large objects automatically
- Clear Vue reactive references

### Phase 3: Selection System Fixes (Critical Priority - NEW)

#### 1. Cascade Selection Protection

**Implementation Strategy**:
- Count files before cascade operations
- Block selections > 100 files with user warning
- Replace recursive algorithms with breadth-first traversal
- Add maximum recursion depth limits (5 levels)
- Implement user confirmation for large operations

#### 2. Reactive State Management

**Set Object Optimization**:
- Limit selectedPaths to 200 items maximum
- Limit expandedPaths to 50 items maximum
- Add debounced cleanup every 1 second
- Auto-cleanup when exceeding limits
- Force reactivity updates after cleanup

#### 3. Click Protection System

**Multi-click Prevention**:
- Debounce clicks (300ms minimum interval)
- Processing state locks during operations
- Error boundaries for selection failures
- Memory monitoring during selections
- Cancel operations if memory exceeds thresholds

### Phase 4: UI Performance Optimization (High Priority)

#### 1. Component Optimization

**FileTreeItem Component**:
- Add click debouncing and processing locks
- Implement null checks and error handling
- Add confirmation dialogs for large operations
- Optimize re-render frequency
- Clean up DOM references on unmount

#### 2. Virtual List Implementation

**Large List Handling**:
- Virtualize file lists > 200 items
- Batch DOM updates for selection changes
- Add loading indicators for heavy operations
- Implement background processing for large selections
- Progressive rendering with cancellation support

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–∏–∑–∫–∏–π)

1. **Advanced Memory Management**
   - IndexedDB –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
   - Web Workers –¥–ª—è background processing
   - Content compression –¥–ª—è transfer/storage

2. **Performance Monitoring**
   - Real-time memory usage indicators
   - Performance metrics dashboard
   - Memory leak detection

## Configuration Strategy

### Memory Limits Approach

Implement aggressive memory limits to prevent OutOfMemory errors:
- Reduce file processing limits to 1/4 of current values
- Replace percentage-based thresholds with absolute MB values
- Implement emergency cleanup procedures at critical thresholds
- Add progressive loading to handle large contexts safely

### Memory Monitoring Strategy

Transition from reactive to proactive memory management:
- Monitor memory usage at shorter intervals (1 second vs 5 seconds)
- Use absolute memory thresholds (15MB warning, 25MB critical) instead of percentages
- Implement automatic cleanup procedures triggered by memory usage
- Add emergency unload procedures for critical memory situations

## Testing and Validation Strategy

### Critical Memory Testing Approach

#### Memory Usage Validation
Implement comprehensive memory testing to ensure stability:
- Test memory usage with minimal file loads (target: under 20MB)
- Validate virtual scrolling performance with large content (target: under 15MB delta)
- Monitor memory patterns during typical user workflows
- Verify memory cleanup effectiveness (target: 30%+ reduction)

#### Performance Benchmarking
Establish performance baselines for memory-critical operations:
- File loading operations should complete within memory budgets
- Virtual scrolling should maintain stable memory usage patterns
- Context switching should not accumulate memory leaks
- Emergency cleanup procedures should restore acceptable memory levels

#### Browser Environment Testing
Validate behavior across different browser configurations:
- Test with memory-constrained environments
- Verify compatibility with WebView2 memory limitations
- Ensure garbage collection mechanisms work effectively
- Monitor performance with browser developer tools

### Performance Benchmarks

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ª–∏–º–∏—Ç |
|---------|------------------|-------------------|
| Memory Usage | < 40MB | < 60MB |
| Context Build Time | < 2s | < 5s |
| Virtual Scroll FPS | > 30 | > 15 |
| File Loading Time | < 500ms | < 1s |

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–±–ª–µ–º (30 –º–∏–Ω—É—Ç)

#### 1.1 –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
cd G:\Sources\shotgun_code
.\dev.ps1  # –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

#### 1.2 Browser-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ MCP Playwright
```typescript
// –û—Ç–∫—Ä–æ–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
// 1. –ó–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
// 2. Virtual scrolling —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞  
// 3. –°–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
// 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ memory usage –≤ DevTools
```

#### 1.3 –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **VirtualScrollViewer.vue** - —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–æ –Ω—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **ContextViewer.vue** - —á–∞—Å—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –Ω–∞ pagination
- **context-builder.store.ts** - —á–∞—Å—Ç–∏—á–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
- **memory-monitor.ts** - –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –µ—Å—Ç—å

### –®–∞–≥ 2: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ (90 –º–∏–Ω—É—Ç)

#### 2.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ memory-monitor.ts (–ö–†–ò–¢–ò–ß–ù–û)
``typescript
// –°–Ω–∏–∑–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
const EMERGENCY_THRESHOLDS = {
  warning: 15,      // 15MB instead of current 70%
  critical: 25,     // 25MB instead of 85%
  emergency: 35,    // 35MB - force unload content
  pollingRate: 500  // Check every 500ms
}
```

#### 2.2 –î–æ—Ä–∞–±–æ—Ç–∫–∞ VirtualScrollViewer.vue
``typescript
// –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É –∫–µ—à–∞
const MAX_CACHE_SIZE = 3;  // –¢–æ–ª—å–∫–æ 3 chunks –≤ –ø–∞–º—è—Ç–∏
const AGGRESSIVE_CLEANUP = true;

// –í onUnmounted –¥–æ–±–∞–≤–∏—Ç—å:
const cleanupEverything = () => {
  cachedLines.value.clear();
  if (window.gc) window.gc();
  setTimeout(() => window.gc?.(), 100);
};
```

#### 2.3 –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –≤ context-builder.store.ts
``typescript
// –≠–ö–°–¢–†–ï–ù–ù–´–ï –õ–ò–ú–ò–¢–´ - –≤ 4 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–∏—Ö
const EMERGENCY_LIMITS = {
  maxFileLimit: 5,              // –±—ã–ª–æ 25
  maxIndividualFileSize: 16 * 1024,  // –±—ã–ª–æ 64KB -> 16KB  
  maxTotalContextSize: 128 * 1024,   // –±—ã–ª–æ 512KB -> 128KB
  chunkSize: 8 * 1024,              // –±—ã–ª–æ 25KB -> 8KB
  maxMemoryUsageWarning: 10,        // –±—ã–ª–æ 20MB -> 10MB
}
```

### –®–∞–≥ 3: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (60 –º–∏–Ω—É—Ç)

#### 3.1 –ì–ª–æ–±–∞–ª—å–Ω—ã–π memory watcher
``typescript
// –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: src/utils/emergency-memory-manager.ts
class EmergencyMemoryManager {
  private static checkInterval = 500; // 500ms
  
  static startEmergencyMode() {
    setInterval(() => {
      const memory = this.getMemoryUsage();
      
      if (memory > 30) {
        // CRITICAL: Force unload everything
        this.emergencyUnload();
      } else if (memory > 20) {
        // WARNING: Aggressive cleanup
        this.aggressiveCleanup();
      } else if (memory > 15) {
        // CAUTION: Regular cleanup
        this.regularCleanup();
      }
    }, this.checkInterval);
  }
}
```

#### 3.2 Component cleanup hooks
``typescript
// –í –∫–∞–∂–¥–æ–º Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å:
const useEmergencyCleanup = () => {
  onUnmounted(() => {
    // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö ref
    Object.keys(getCurrentInstance()?.refs || {}).forEach(key => {
      const ref = getCurrentInstance()?.refs[key];
      if (ref && typeof ref === 'object') {
        (ref as any).value = null;
      }
    });
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC
    if (window.gc) {
      setTimeout(() => window.gc?.(), 50);
      setTimeout(() => window.gc?.(), 200);
    }
  });
};
```

### –®–∞–≥ 4: Browser-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (45 –º–∏–Ω—É—Ç)

#### 4.1 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ MCP Playwright
``typescript
// –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
// 1. –ó–∞–≥—Ä—É–∑–∫–∞ 5 —Ñ–∞–π–ª–æ–≤ –ø–æ 16KB –∫–∞–∂–¥—ã–π
// 2. Virtual scroll —á–µ—Ä–µ–∑ 500 —Å—Ç—Ä–æ–∫
// 3. –°–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ 3 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥
// 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ memory < 25MB throughout
```

#### 4.2 Manual testing —Å—Ü–µ–Ω–∞—Ä–∏–∏
``typescript
// –í DevTools Console:
setInterval(() => {
  const mem = performance.memory;
  console.log(`Memory: ${(mem.usedJSHeapSize/1024/1024).toFixed(1)}MB`);
  if (mem.usedJSHeapSize > 25*1024*1024) {
    console.error('üö® MEMORY EXCEEDED 25MB!');
  }
}, 1000);
```

### –®–∞–≥ 5: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (30 –º–∏–Ω—É—Ç)

#### 5.1 Performance validation
- Memory usage consistently < 25MB
- No WebView2 crashes
- Responsive UI (no hanging)
- Quick context switching

#### 5.2 User experience validation
- Clear memory warnings
- Graceful degradation
- No data loss during cleanup

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞

### 1. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: memory-monitor.ts

#### –ü—Ä–æ–±–ª–µ–º–∞
–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ (70%, 85%), –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏ –¥–ª—è WebView2. –ù—É–∂–Ω—ã –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ MB.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
``typescript
// –í frontend/src/utils/memory-monitor.ts
// –ó–ê–ú–ï–ù–ò–¢–¨ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å MemoryWarningOptions:
export interface MemoryWarningOptions {
  warningThreshold?: number;   // Absolute memory threshold in MB (default: 15)
  criticalThreshold?: number;  // Absolute memory threshold in MB (default: 25)
  emergencyThreshold?: number; // Absolute memory threshold in MB (default: 35)
  pollingInterval?: number;    // How often to check memory in ms (default: 500)
  showToasts?: boolean;        // Whether to show toast notifications (default: true)
  autoCleanup?: boolean;       // Whether to auto cleanup when critical (default: true)
  aggressiveMode?: boolean;    // Whether to use aggressive memory management (default: true)
  forceGCInterval?: number;    // How often to force GC in ms (default: 3000)
}

// –ó–ê–ú–ï–ù–ò–¢–¨ DEFAULT_OPTIONS:
const DEFAULT_OPTIONS: MemoryWarningOptions = {
  warningThreshold: 15,      // 15MB warning threshold
  criticalThreshold: 25,     // 25MB critical threshold
  emergencyThreshold: 35,    // 35MB emergency threshold
  pollingInterval: 500,      // Check every 500ms
  showToasts: true,
  autoCleanup: true,
  aggressiveMode: true,
  forceGCInterval: 3000      // Force GC every 3 seconds
};

// –î–û–ë–ê–í–ò–¢–¨ –≤ –∫–ª–∞—Å—Å MemoryMonitor –Ω–æ–≤—ã–µ –ø–æ–ª—è:
private forceGCInterval: number | null = null;
private emergencyIssued = false;
private cleanupCallbacks: (() => void)[] = [];

// –ó–ê–ú–ï–ù–ò–¢–¨ –º–µ—Ç–æ–¥ checkMemory() –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
private checkMemory(): void {
  const stats = this.getMemoryStats();
  if (!stats) return;
  
  const { used, total } = stats;
  
  // Emergency threshold (35MB)
  if (used >= (this.options.emergencyThreshold || 35)) {
    if (!this.emergencyIssued) {
      console.error(`üö® EMERGENCY: Memory usage at ${used}MB`);
      this.emergencyUnload();
      this.emergencyIssued = true;
    }
  }
  // Critical threshold (25MB)  
  else if (used >= (this.options.criticalThreshold || 25)) {
    if (!this.criticalIssued) {
      console.warn(`‚ö†Ô∏è CRITICAL: Memory usage at ${used}MB`);
      if (this.options.autoCleanup) this.forceCleanup();
      this.criticalIssued = true;
    }
  }
  // Warning threshold (15MB)
  else if (used >= (this.options.warningThreshold || 15)) {
    if (!this.warningIssued) {
      console.warn(`‚ö° WARNING: Memory usage at ${used}MB`);
      this.warningIssued = true;
    }
  }
  else {
    // Reset flags
    this.warningIssued = false;
    this.criticalIssued = false;
    this.emergencyIssued = false;
  }
}

// –î–û–ë–ê–í–ò–¢–¨ –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
public emergencyUnload(): void {
  console.error('üö® EMERGENCY MEMORY UNLOAD!');
  this.cleanupCallbacks.forEach(callback => callback());
  
  // Multiple aggressive GC cycles
  for (let i = 0; i < 5; i++) {
    setTimeout(() => { if (window.gc) window.gc(); }, i * 100);
  }
  
  window.dispatchEvent(new CustomEvent('emergency-memory-cleanup'));
}

public registerCleanupCallback(callback: () => void): void {
  this.cleanupCallbacks.push(callback);
}
```

### 2. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: context-builder.store.ts

#### –ü—Ä–æ–±–ª–µ–º–∞
–õ–∏–º–∏—Ç—ã –≤—Å–µ –µ—â–µ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
``typescript
// –í frontend/src/stores/context-builder.store.ts
// –ó–ê–ú–ï–ù–ò–¢–¨ –≤—Å–µ –ª–∏–º–∏—Ç—ã –Ω–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ –Ω–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:

const EMERGENCY_LIMITS = {
  maxFileLimit: 5,              // –±—ã–ª–æ: 25 -> 5 —Ñ–∞–π–ª–æ–≤ –º–∞–∫—Å–∏–º—É–º
  maxIndividualFileSize: 16 * 1024,  // –±—ã–ª–æ: 64KB -> 16KB
  maxTotalContextSize: 64 * 1024,    // –±—ã–ª–æ: 512KB -> 64KB
  chunkSize: 8 * 1024,              // –±—ã–ª–æ: 25KB -> 8KB
  maxMemoryUsageWarning: 10,        // –±—ã–ª–æ: 20MB -> 10MB
  maxSelectedFiles: 5,              // –±—ã–ª–æ: 10 -> 5 —Ñ–∞–π–ª–æ–≤
  maxSuggestions: 2,                // –±—ã–ª–æ: 3 -> 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
};

// –ó–ê–ú–ï–ù–ò–¢–¨ –∑–Ω–∞—á–µ–Ω–∏—è:
const maxFileLimit = ref(5);           // –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ –Ω–∏–∑–∫–∏–π –ª–∏–º–∏—Ç
const maxIndividualFileSize = ref(16 * 1024);  // 16KB
const maxTotalContextSize = ref(64 * 1024);    // 64KB
const chunkSize = ref(8 * 1024);               // 8KB chunks
const maxMemoryUsageWarning = ref(10);         // 10MB warning
```

### 3. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: VirtualScrollViewer.vue

#### –ü—Ä–æ–±–ª–µ–º–∞
–ù—É–∂–Ω–∞ –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–∏–¥–∏–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
``typescript
// –í frontend/src/presentation/components/shared/VirtualScrollViewer.vue
// –ó–ê–ú–ï–ù–ò–¢–¨ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:

const MAX_LINES_ABSOLUTE = 1000;     // –±—ã–ª–æ: 5000 -> 1000 —Å—Ç—Ä–æ–∫ max
const MAX_VISIBLE_LINES = 50;        // –±—ã–ª–æ: 200 -> 50 —Å—Ç—Ä–æ–∫
const CACHE_LIMIT = 3;               // –±—ã–ª–æ: 10 -> 3 chunks –≤ –∫–µ—à–µ
const OVERSCAN_LIMIT = 0;            // –±—ã–ª–æ: 1 -> 0 (–±–µ–∑ overscan)
const MEMORY_CHECK_INTERVAL = 1000;  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É

// –î–û–ë–ê–í–ò–¢–¨ –≤ onMounted:
onMounted(() => {
  // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º cleanup callback
  const memoryMonitor = useMemoryMonitor();
  memoryMonitor.registerCleanupCallback(() => {
    cachedLines.value.clear();
    console.log('VirtualScrollViewer: Cache cleared by memory monitor');
  });
  
  // –°–ª—É—à–∞–µ–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –æ—á–∏—Å—Ç–∫—É
  window.addEventListener('emergency-memory-cleanup', () => {
    cachedLines.value.clear();
    if (containerRef.value) {
      containerRef.value.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å DOM
    }
  });
});

// –ó–ê–ú–ï–ù–ò–¢–¨ onUnmounted:
onUnmounted(() => {
  // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
  cachedLines.value.clear();
  
  if (containerRef.value) {
    containerRef.value.innerHTML = '';
  }
  
  // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC
  if (window.gc) {
    setTimeout(() => window.gc?.(), 50);
    setTimeout(() => window.gc?.(), 200);
  }
});
```

### 4. –≠–ö–°–¢–†–ï–ù–ù–´–ô –ì–õ–û–ë–ê–õ–¨–ù–´–ô MEMORY MANAGER

#### –ù–æ–≤—ã–π —Ñ–∞–π–ª: frontend/src/utils/emergency-memory-manager.ts
``typescript
// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª
import { useMemoryMonitor } from './memory-monitor';

class EmergencyMemoryManager {
  private static instance: EmergencyMemoryManager;
  private memoryMonitor = useMemoryMonitor({
    warningThreshold: 10,     // 10MB warning
    criticalThreshold: 20,    // 20MB critical  
    emergencyThreshold: 30,   // 30MB emergency
    pollingInterval: 500,     // Check every 500ms
    aggressiveMode: true,
    forceGCInterval: 2000     // Force GC every 2s
  });

  static getInstance(): EmergencyMemoryManager {
    if (!this.instance) {
      this.instance = new EmergencyMemoryManager();
    }
    return this.instance;
  }

  startEmergencyMode(): void {
    console.log('üö® STARTING EMERGENCY MEMORY MODE');
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    this.memoryMonitor.startMonitoring();
    
    // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É
    this.memoryMonitor.registerCleanupCallback(() => {
      this.globalCleanup();
    });
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
    setInterval(() => {
      const stats = this.memoryMonitor.getMemoryStats();
      if (stats && stats.used > 15) {
        if (window.gc) window.gc();
        console.log(`üóëÔ∏è Force GC: ${stats.used}MB`);
      }
    }, 3000);
  }

  private globalCleanup(): void {
    console.log('üßπ Global emergency cleanup');
    
    // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —á—Ç–æ –º–æ–∂–Ω–æ
    (window as any).largeObjects = [];
    
    // –û—á–∏—Å—Ç–∏—Ç—å Vue stores –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
    try {
      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤—Å–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
      window.dispatchEvent(new CustomEvent('global-cleanup', {
        detail: { level: 'emergency' }
      }));
    } catch (e) {
      console.warn('Global cleanup event failed:', e);
    }
  }
}

export default EmergencyMemoryManager;
```

### 6. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: useTriStateSelection.ts (–ù–û–í–û–ï)

#### –ü—Ä–æ–±–ª–µ–º–∞
–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –ø–∞–ø–æ–∫ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å stack overflow –∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –æ–≥—Ä–æ–º–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ cascade selection.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```typescript
// –í frontend/src/composables/useTriStateSelection.ts
// –ó–ê–ú–ï–ù–ò–¢–¨ –≤–µ—Å—å —Ñ–∞–π–ª –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –≤–µ—Ä—Å–∏—é:

import type { FileNode } from "@/types/dto";

export type Sel = "on" | "off" | "partial";

const MAX_CASCADE_FILES = 100;  // –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –õ–ò–ú–ò–¢
const MAX_RECURSION_DEPTH = 5;  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞

export function useTriStateSelection(
  nodesMap: Map<string, FileNode>,
  selectedPaths: Set<string>,
) {
  function computeSelection(node: FileNode, depth: number = 0): Sel {
    // –ó–ê–©–ò–¢–ê –û–¢ –ì–õ–£–ë–û–ö–û–ô –†–ï–ö–£–†–°–ò–ò
    if (depth > MAX_RECURSION_DEPTH) {
      console.warn(`Max recursion depth reached for ${node.path}`);
      return selectedPaths.has(node.path) ? "on" : "off";
    }
    
    if (!node.isDir) return selectedPaths.has(node.path) ? "on" : "off";
    
    const children = (node.children || [])
      .map((c) => nodesMap.get(c.path))
      .filter(Boolean) as FileNode[];
      
    if (children.length === 0)
      return selectedPaths.has(node.path) ? "on" : "off";
    
    // –õ–ò–ú–ò–¢ –ù–ê –ö–û–õ–ò–ß–ï–°–¢–í–û –î–ï–¢–ï–ô
    if (children.length > 1000) {
      console.warn(`Too many children (${children.length}) in ${node.path}, limiting selection`);
      return "partial"; // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π fallback
    }
    
    let hasOn = false, hasOff = false;
    for (const ch of children) {
      if (ch.isIgnored) continue;
      const st = computeSelection(ch, depth + 1);
      if (st === "partial") return "partial";
      if (st === "on") hasOn = true;
      if (st === "off") hasOff = true;
      if (hasOn && hasOff) return "partial";
    }
    
    if (hasOn && !hasOff) return "on";
    if (!hasOn && hasOff) return "off";
    return "off";
  }

  function toggleCascade(node: FileNode): boolean {
    const select = !selectedPaths.has(node.path);
    
    // –ü–û–î–°–ß–ï–¢ –§–ê–ô–õ–û–í –ü–ï–†–ï–î –û–ü–ï–†–ê–¶–ò–ï–ô
    const filesToProcess = countFilesInNode(node);
    if (filesToProcess > MAX_CASCADE_FILES) {
      console.error(`Cannot select folder with ${filesToProcess} files (max: ${MAX_CASCADE_FILES})`);
      alert(`This folder contains ${filesToProcess} files. Maximum allowed is ${MAX_CASCADE_FILES}. Please select smaller folders.`);
      return false;
    }
    
    // BREADTH-FIRST –û–ë–•–û–î –í–ú–ï–°–¢–û –†–ï–ö–£–†–°–ò–ò
    const queue: FileNode[] = [node];
    let processed = 0;
    
    while (queue.length > 0 && processed < MAX_CASCADE_FILES) {
      const cur = queue.shift()!;
      
      if (!cur.isIgnored) {
        if (select) selectedPaths.add(cur.path);
        else selectedPaths.delete(cur.path);
        processed++;
        
        if (cur.isDir && cur.children) {
          for (const c of cur.children) {
            const childNode = nodesMap.get(c.path);
            if (childNode && processed < MAX_CASCADE_FILES) {
              queue.push(childNode);
            }
          }
        }
      }
    }
    
    if (processed >= MAX_CASCADE_FILES) {
      console.warn(`Cascade selection stopped at ${processed} files`);
    }
    
    return true;
  }
  
  // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–î–°–ß–ï–¢–ê –§–ê–ô–õ–û–í
  function countFilesInNode(node: FileNode, maxCount: number = MAX_CASCADE_FILES + 1): number {
    let count = 0;
    const queue: FileNode[] = [node];
    
    while (queue.length > 0 && count <= maxCount) {
      const cur = queue.shift()!;
      
      if (!cur.isIgnored) {
        count++;
        
        if (cur.isDir && cur.children) {
          for (const c of cur.children) {
            const childNode = nodesMap.get(c.path);
            if (childNode) {
              queue.push(childNode);
            }
          }
        }
      }
    }
    
    return count;
  }

  return { computeSelection, toggleCascade, countFilesInNode };
}
```

### 7. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: tree-state.store.ts (–ù–û–í–û–ï)

#### –ü—Ä–æ–±–ª–µ–º–∞
Reactive Set objects –±–µ–∑ proper cleanup –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç memory leaks.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```typescript
// –í frontend/src/stores/tree-state.store.ts
// –î–û–ë–ê–í–ò–¢–¨ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞:

const MAX_SELECTED_PATHS = 200;   // –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –õ–ò–ú–ò–¢
const MAX_EXPANDED_PATHS = 50;    // –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –õ–ò–ú–ò–¢
const MAX_SELECTION_BATCH = 50;   // –ú–∞–∫—Å–∏–º—É–º –∑–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é

// –ó–ê–ú–ï–ù–ò–¢–¨ toggleNodeSelection:
function toggleNodeSelection(path: string, nodesMap: Map<string, FileNode>) {
  const node = nodesMap.get(path);
  if (!node || node.isIgnored) return;
  
  // –ü–†–û–í–ï–†–ö–ê –õ–ò–ú–ò–¢–û–í –ü–ï–†–ï–î –û–ü–ï–†–ê–¶–ò–ï–ô
  if (!selectedPaths.value.has(path) && selectedPaths.value.size >= MAX_SELECTED_PATHS) {
    console.error(`Maximum selected paths (${MAX_SELECTED_PATHS}) reached`);
    alert(`Maximum number of selected files (${MAX_SELECTED_PATHS}) reached. Please deselect some files first.`);
    return;
  }
  
  const { toggleCascade, countFilesInNode } = useTriStateSelection(nodesMap, selectedPaths.value);
  
  // –î–õ–Ø –ü–ê–ü–û–ö - –ü–†–û–í–ï–†–ò–¢–¨ –†–ê–ó–ú–ï–† –ü–ï–†–ï–î CASCADE
  if (node.isDir) {
    const filesCount = countFilesInNode(node);
    if (filesCount > 100) {
      const confirm = window.confirm(
        `This folder contains ${filesCount} files. Selecting it may cause performance issues. Continue?`
      );
      if (!confirm) return;
    }
  }
  
  const success = toggleCascade(node);
  if (success) {
    updateParentSelection(path, nodesMap);
  }
}

// –î–û–ë–ê–í–ò–¢–¨ debounced –æ—á–∏—Å—Ç–∫—É:
let cleanupTimeout: number | null = null;

function scheduleCleanup() {
  if (cleanupTimeout) clearTimeout(cleanupTimeout);
  
  cleanupTimeout = window.setTimeout(() => {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö Set objects
    if (selectedPaths.value.size > MAX_SELECTED_PATHS) {
      console.warn('Selected paths exceeded limit, clearing excess');
      const pathsArray = Array.from(selectedPaths.value);
      selectedPaths.value.clear();
      pathsArray.slice(0, MAX_SELECTED_PATHS).forEach(path => 
        selectedPaths.value.add(path)
      );
    }
    
    if (expandedPaths.value.size > MAX_EXPANDED_PATHS) {
      console.warn('Expanded paths exceeded limit, clearing excess');
      const pathsArray = Array.from(expandedPaths.value);
      expandedPaths.value.clear();
      pathsArray.slice(0, MAX_EXPANDED_PATHS).forEach(path => 
        expandedPaths.value.add(path)
      );
    }
  }, 1000);
}

// –ó–ê–ú–ï–ù–ò–¢–¨ clearSelection:
function clearSelection() {
  selectedPaths.value.clear();
  // Force reactivity update
  selectedPaths.value = new Set(selectedPaths.value);
}

// –ó–ê–ú–ï–ù–ò–¢–¨ resetState:
function resetState() {
  expandedPaths.value.clear();
  selectedPaths.value.clear();
  activeNodePath.value = null;
  
  if (cleanupTimeout) {
    clearTimeout(cleanupTimeout);
    cleanupTimeout = null;
  }
  
  // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC
  if (window.gc) {
    setTimeout(() => window.gc?.(), 100);
  }
}
```

### 8. –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: file-tree.store.ts (–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û–ï)

#### –ü—Ä–æ–±–ª–µ–º–∞
–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç –≤—ã–±–æ—Ä–∞ root –ø–∞–ø–æ–∫ —Å —Ç—ã—Å—è—á–∞–º–∏ —Ñ–∞–π–ª–æ–≤.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```typescript
// –í frontend/src/stores/file-tree.store.ts
// –ó–ê–ú–ï–ù–ò–¢–¨ toggleNodeSelection:

function toggleNodeSelection(path: string) {
  const node = nodesMap.value.get(path);
  if (!node) return;
  
  // –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–©–ò–¢–ê –î–õ–Ø ROOT –ü–ê–ü–û–ö
  if (node.isDir) {
    const fileCount = countFilesInDirectory(node);
    if (fileCount > 500) {
      console.error(`Directory ${path} contains ${fileCount} files (max: 500)`);
      alert(`This directory contains ${fileCount} files, which exceeds the limit of 500. Please select individual files or smaller subdirectories.`);
      return;
    }
  }
  
  // Check if we're at the limit before adding
  if (!treeStateStore.selectedPaths.has(path) && selectedFiles.value.length >= 200) {
    console.warn("Maximum number of selected files (200) reached. Cannot select more files.");
    alert("Maximum number of selected files (200) reached. Please deselect some files first.");
    return;
  }
  
  treeStateStore.toggleNodeSelection(path, nodesMap.value as Map<string, FileNode>);
}

// –î–û–ë–ê–í–ò–¢–¨ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–¥—Å—á–µ—Ç–∞ —Ñ–∞–π–ª–æ–≤:
function countFilesInDirectory(node: FileNode): number {
  let count = 0;
  const queue: FileNode[] = node.children ? [...node.children] : [];
  
  while (queue.length > 0 && count < 1000) { // –°—Ç–æ–ø –Ω–∞ 1000 –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    const current = queue.shift()!;
    const currentNode = nodesMap.value.get(current.path);
    
    if (currentNode && !currentNode.isIgnored) {
      if (!currentNode.isDir) {
        count++;
      } else if (currentNode.children) {
        queue.push(...currentNode.children);
      }
    }
  }
  
  return count;
}

// –ó–ê–ú–ï–ù–ò–¢–¨ selectAll:
function selectAll() {
  const allFiles = getAllFiles();
  const maxFiles = 100; // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –°–ù–ò–ñ–ï–ù–ò–ï
  
  if (allFiles.length > maxFiles) {
    const confirm = window.confirm(
      `This project contains ${allFiles.length} files. Selecting all may cause memory issues. Select first ${maxFiles} files instead?`
    );
    if (!confirm) return;
  }
  
  let count = 0;
  
  nodesMap.value.forEach((node) => {
    if (count >= maxFiles) return;
    
    if (!node.isDir && !node.isGitignored && !node.isCustomIgnored) {
      treeStateStore.selectedPaths.add(node.path);
      count++;
    }
  });
  
  if (count >= maxFiles) {
    console.warn(`Selected ${count} files (limited to prevent memory issues)`);
  }
}
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
``typescript
// –í frontend/src/main.ts
// –î–û–ë–ê–í–ò–¢–¨ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è app:

import EmergencyMemoryManager from '@/utils/emergency-memory-manager';

// –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
if (process.env.NODE_ENV === 'development' || import.meta.env.DEV) {
  EmergencyMemoryManager.getInstance().startEmergencyMode();
  console.log('üö® Emergency memory management activated');
}

// –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞–º—è—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏
if (import.meta.env.DEV) {
  setInterval(() => {
    const memory = (performance as any).memory;
    if (memory) {
      const used = Math.round(memory.usedJSHeapSize / 1024 / 1024);
      console.log(`üìä Memory: ${used}MB`);
      
      if (used > 25) {
        console.error('üö® MEMORY CRITICAL!');
      } else if (used > 15) {
        console.warn('‚ö†Ô∏è MEMORY HIGH');
      }
    }
  }, 2000);
}
```

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞)

#### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ OOM –æ—à–∏–±–æ–∫
- ‚úÖ **–¶–ï–õ–¨**: 0 WebView2 crashes –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–∞–º–∏ < 32KB
- ‚úÖ **–¶–ï–õ–¨**: Memory usage < 25MB –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ 10 —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–¶–ï–õ–¨**: Stable virtual scrolling –¥–æ 1000 —Å—Ç—Ä–æ–∫

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ª–∏–º–∏—Ç—ã
``typescript
interface CriticalMetrics {
  maxMemoryUsage: 30;        // MB - –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ª–∏–º–∏—Ç
  maxFileSize: 32 * 1024;    // 32KB per file
  maxTotalFiles: 10;         // —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
  maxVirtualLines: 1000;     // —Å—Ç—Ä–æ–∫ –≤ virtual scroll
  gcInterval: 3000;          // ms - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC
}
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- Memory monitor –∫–∞–∂–¥—ã–µ 500ms
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ 20MB+
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π GC –ø—Ä–∏ 25MB+
- Emergency file unload –ø—Ä–∏ 30MB+

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### DevTools Integration
``typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
if (process.env.NODE_ENV === 'development') {
  setInterval(() => {
    const memory = performance.memory;
    console.log(`Memory: ${(memory.usedJSHeapSize/1024/1024).toFixed(1)}MB`);
    
    if (memory.usedJSHeapSize > 30 * 1024 * 1024) {
      console.error('üö® MEMORY CRITICAL! Emergency cleanup needed!');
      emergencyCleanup();
    }
  }, 1000);
}
```

#### User Alerts
- üü° Warning –ø—Ä–∏ 15MB: "–ü–∞–º—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –Ω–∞ 50%"
- üü† Alert –ø—Ä–∏ 20MB: "–í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ - –∑–∞–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª—ã"
- üî¥ Critical –ø—Ä–∏ 25MB: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –Ω–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏ - —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞"

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### Runtime Monitoring
- Real-time memory usage indicators
- Performance metrics –≤ DevTools
- Automatic error reporting

### User Feedback
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –≤—ã—Å–æ–∫–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–∞–º—è—Ç–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- Progressive loading indicators

### Logging –∏ Analytics
- Memory usage patterns
- Performance degradation detection
- User behavior impact analysis

## –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ MCP Playwright

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

#### 1.1 –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
``bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
cd G:\Sources\shotgun_code
.\dev.ps1
```

#### 1.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- URL: `http://localhost:5173` (–≤–µ—Ä–æ—è—Ç–Ω–æ Vite dev server)
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ: `http://localhost:34115` (Wails dev server)

### –≠—Ç–∞–ø 2: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### 2.1 –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ú–ò–ù–ò–ú–£–ú)
**–¶–µ–ª—å**: Memory usage < 15MB —Å 2-3 –º–∞–ª–µ–Ω—å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏

#### 2.2 Virtual Scrolling (–ö–†–ò–¢–ò–ß–ù–´–ô)
**–¶–µ–ª—å**: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–µ 500+ —Å—Ç—Ä–æ–∫

#### 2.3 –°–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ (–ö–†–ò–¢–ò–ß–ù–´–ô)
**–¶–µ–ª—å**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ memory leaks –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

#### 2.4 –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–≠–ö–°–¢–†–ï–ú–ê–õ–¨–ù–´–ô)
**–¶–µ–ª—å**: Graceful degradation –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
- ‚úÖ Memory usage < 15MB –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ memory leaks –ø—Ä–∏ virtual scrolling
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ browser crashes
- ‚úÖ User warnings –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø–∞–º—è—Ç—å—é –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Shotgun Code. –û—Å–Ω–æ–≤–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç —Å–¥–µ–ª–∞–Ω –Ω–∞:

1. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–º —Å–Ω–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤** - —Ñ–∞–π–ª—ã –¥–æ 16KB, –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ 64KB
2. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç—å—é** - GC –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
3. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ 20MB
4. **–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ** - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ 30MB

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–∂–∏–¥–∞–µ—Ç—Å—è:
- –ü–æ–ª–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ WebView2 crashes
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å memory usage < 25MB
- Responsive UI –±–µ–∑ –∑–∞–≤–∏—Å–∞–Ω–∏–π
- Graceful degradation –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞
- –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã

### üîÑ –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```bash
   cd G:\Sources\shotgun_code
   .\dev.ps1
   ```

2. **–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ MCP Playwright:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å memory usage –≤ –±–∞–∑–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –ø–∞–º—è—Ç–∏
   - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å virtual scrolling
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–º–µ–Ω—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

3. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞:**
   - –û–±–Ω–æ–≤–∏—Ç—å memory-monitor.ts —Å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏ (15MB/25MB/35MB)
   - –°–Ω–∏–∑–∏—Ç—å –ª–∏–º–∏—Ç—ã –≤ context-builder.store.ts –¥–æ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –î–æ–±–∞–≤–∏—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é –æ—á–∏—Å—Ç–∫—É –≤ VirtualScrollViewer.vue
   - –°–æ–∑–¥–∞—Ç—å EmergencyMemoryManager –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üéØ –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
- **Memory usage < 15MB** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ 5 —Ñ–∞–π–ª–æ–≤ –ø–æ 16KB
- **–°—Ç–∞–±–∏–ª—å–Ω—ã–π virtual scrolling** –¥–æ 1000 —Å—Ç—Ä–æ–∫ –±–µ–∑ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ WebView2 crashes** –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- **Graceful warnings** –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ –ª–∏–º–∏—Ç–∞–º –ø–∞–º—è—Ç–∏

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ memory usage –≤ DevTools
- Stress-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ñ–∞–π–ª–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
- –°–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ—Ç–∑—ã–≤–æ–≤ –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º OutOfMemory.**
