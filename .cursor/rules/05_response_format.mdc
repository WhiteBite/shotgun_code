---
alwaysApply: true
priority: high
tags: ['format','edits','contracts']
---
# Response Format (Edits JSON / SAP)

- Возвращай ТОЛЬКО структурированный JSON (Edits JSON / SAP).
- Никаких git diff, никакого свободного текста вокруг (кроме metadata.reason).
- Схема см. docs/schemas/edits.schema.json.
- Запрещено писать абсолютные пути или выходить за пределы рабочей директории (без ../).
- Разрешённые стратегии: ast | symbol | anchor | fullFile (fullFile — как крайняя мера).
- Для anchor-операций используй устойчивые якоря (before/after окна) + hash окна.
- Для recipe/ast операций указывай engine (openrewrite/ts-morph/go-ast/libcst).
- Если задача крупная/многошаговая — можно вернуть короткий план (JSON), но по умолчанию сразу edits.
