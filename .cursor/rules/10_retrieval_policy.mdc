---
alwaysApply: true
tags: ['retrieval','context','code-intel']
---
# Retrieval Policy

Порядок источников:
1) Символы/типизация через LSP/LSIF/SCIP.
2) Code Graph: граф импортов/вызовов/референсов; соседи 1–2 хопа.
3) Тесты рядом (coverage/refs).
4) Эмбеддинги (Qdrant/Faiss) — вспомогательный сигнал, отфильтрованный графом.

Упаковка контекста:
- Manifest -> файлы по алфавиту.
- Для больших файлов — «умные вырезки»: заголовок/импорты, сигнатуры и окрестности совпадений.
- Стабильная сортировка и фиксированные заголовки блоков.
- Следи за токен-бюджетом.
